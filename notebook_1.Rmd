---
title: "R Notebook"
output: html_notebook
---

```{r}
# install libraries
library(tidyverse)
```
```{r}
tot_pop_df <- read_csv("5Y2016_S0101.csv", n_max = 1)
head(tot_pop_df)
```

```{r}
tot_pop_edited <- tot_pop_df %>%
  rename(
    "Miami-Dade" = "Miami-Dade County, Florida!!Total!!Estimate",
    "Broward" = "Broward County, Florida!!Total!!Estimate",
    "Palm Beach" = "Palm Beach County, Florida!!Total!!Estimate",
    "Monroe" = "Monroe County, Florida!!Total!!Estimate"
  )
tot_pop_edited
```
```{r}
tgt_counties <- c("Miami-Dade", "Broward", "Palm Beach", "Monroe")
tot_pop_tgts <- tot_pop_edited %>% select(tgt_counties)
head(tot_pop_tgts)
```


```{r}
commute_time <- read_csv("commuteTime45_2012_16.csv")
commute_time
```
```{r}
#
filter_tgt_counties <- function(df) {
  return(df %>% filter(
    County %in% tgt_counties
  ))
}
```


```{r}
#
commute_time_tgts <- filter_tgt_counties(commute_time)
commute_time_tgts
```


```{r}
tot_pop_tgts <- tot_pop_tgts[, order(names(tot_pop_tgts))]
tot_pop_tgts
```


```{r}
# Function to Calculate percent values
calc_percent <- function(df) {
  return(t(t(df[, "Value"]) / as.vector(unlist(tot_pop_tgts[1, ]))))
}
```


```{r}
# perc_commuters = t(t(commute_time_tgts[,"Value"]) / as.vector(unlist(tot_pop_tgts[1,])))
perc_commuters <- calc_percent(commute_time_tgts)
perc_commuters
```
```{r}
# Sanity Check
132304 / 1863780
```
```{r}
commRate <- data.frame(County = tgt_counties, Rate = perc_commuters)
commRate
```


```{r}
heart_attack <- read_csv("heartAttackER_2012_16.csv")
heart_attack
```
```{r}
heart_attack_tgts <- filter_tgt_counties(heart_attack)
heart_attack_tgts
```
```{r}
heart_attack_tgts_mean <- heart_attack_tgts %>%
  group_by(County) %>%
  summarise(mean(Value))

heart_attack_tgts_mean
```
```{r}
#
heart_attack_tgts_mean <- heart_attack_tgts_mean %>%
  rename(
    "Value" = "mean(Value)"
  )
names(heart_attack_tgts_mean)
```

```{r}
# perc_heart_attacks <- t(t(commute_time_tgts[, "Value"]) / as.vector(unlist(tot_pop_tgts[1, ])))
perc_heart_attacks <- calc_percent(commute_time_tgts)
perc_heart_attacks
```

```{r}
hospRate <- data.frame(County = tgt_counties, Rate = perc_heart_attacks)
hospRate
```
```{r}
rate_data = data.frame(County = hospRate[,1], hospRate = hospRate[,2], commRate = commRate[,2])
rate_data
```

